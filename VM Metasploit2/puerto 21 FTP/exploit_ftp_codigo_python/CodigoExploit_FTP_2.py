import socket
import time

print("Conexion FTP.. \n")

host = input("Digite el host -> ")
puerto = input("Digite el puerto -> ")

#socket
cliente_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#conexion
def connect():
    try:
        print("[*] Estableciendo conexion.. \n")
        time.sleep(3)
        cliente_socket.connect((host,int(puerto)))
        respuesta = cliente_socket.recv(1024).decode("utf-8")
        print(respuesta)
    except socket.error as e:
        print(f"Error en la conexion: {e}")

#send y recv
def send_recv():
    try:
        username = input("[*] Digite nombre de usuario -> ")
        if username.lower() == "msfadmin": 
            cliente_socket.send(("USER " + username + "\r\n").encode())
            respuesta = cliente_socket.recv(1024).decode("utf-8")
            print(respuesta)
        else:
            print("Error en el usuario..")

        password = input("[*] Digite la clave -> ")
        if password.lower() == "msfadmin":
            cliente_socket.send(("PASS " + password + "\r\n").encode())
            respuesta = cliente_socket.recv(1024).decode("utf-8")
            print(respuesta)
        else: 
            print("Error en el ingreso de la clave.")

        while True:
            consola = input("[*] Digite un comando o exit para salir: \n")
            if consola.lower() == "exit":
                print("Fin del programa..")
                break

            cliente_socket.send((consola + "\r\n").encode())
            respuesta = cliente_socket.recv(1024).decode("utf-8")
            print(respuesta)

    except socket.error as e:
        print(f"Error de envio {e}")        

if __name__ == '__main__':
    try:
        connect()
        send_recv()

        cliente_socket.close()
    except KeyboardInterrupt as e:
        print(f"Salio.{e}")